<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>KDA — Vernacular Writing UX Demo</title>
  <meta name="description" content="Demonstration site: vernacular writing issues, user-friendly data entry form, prompts, and automated data transfer." />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&display=swap" rel="stylesheet">

  <!-- Chart.js CDN -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <style>
    :root{
      --bg-1: #0b1020;
      --bg-2: #071033;
      --glass: rgba(255,255,255,0.04);
      --muted: #9fb0d7;
      --accent: #6d5cff;
      --accent-2: #00d4ff;
      --success: #16a34a;
      --danger: #ef4444;
      --card-radius: 16px;
      --maxw:1120px;
      --shadow: 0 10px 40px rgba(3,6,23,0.6);
      --glass-border: rgba(255,255,255,0.03);
    }
    *{box-sizing:border-box}
    body{
      margin:0;min-height:100vh;
      font-family:Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      background: linear-gradient(160deg,var(--bg-1) 0%, var(--bg-2) 60%);
      color:#e8f1ff;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      padding:28px;display:flex;justify-content:center;
    }
    .wrap{width:100%;max-width:var(--maxw);}

    header{display:flex;align-items:center;gap:16px;margin-bottom:18px}
    .logo{
      width:68px;height:68px;border-radius:14px;
      background:linear-gradient(135deg,var(--accent),var(--accent-2));
      display:flex;align-items:center;justify-content:center;font-weight:800;font-size:20px;box-shadow:0 8px 30px rgba(109,92,255,0.25);
    }
    h1{margin:0;font-size:1.4rem}
    p.lead{margin:6px 0 0;color:var(--muted);font-size:0.95rem}

    main.grid{display:grid;grid-template-columns:1fr 420px;gap:18px;align-items:start}
    .card{
      background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      border-radius:var(--card-radius);
      padding:18px;box-shadow:var(--shadow);
      border:1px solid var(--glass-border);
    }

    /* Hero & explanation */
    .hero{
      display:flex;align-items:flex-start;gap:16px;margin-bottom:12px;
    }
    .hero .badge{background:rgba(255,255,255,0.03);padding:6px 10px;border-radius:999px;color:var(--accent);font-weight:700}

    /* form */
    form {margin-top:10px}
    label{display:block;margin-bottom:8px;font-weight:700}
    input[type="text"], textarea, select {
      width:100%;padding:12px;border-radius:12px;border:1px solid rgba(255,255,255,0.04);
      background: rgba(255,255,255,0.02); color: inherit;font-size:0.95rem;
    }
    textarea{min-height:92px;resize:vertical}
    input:focus, textarea:focus, select:focus{outline:3px solid rgba(109,92,255,0.12);border-color:rgba(109,92,255,0.28)}
    .hint{font-size:0.88rem;color:var(--muted);margin-top:6px}
    .small{font-size:0.86rem;color:var(--muted)}

    .row{display:flex;gap:12px}
    .row.col2{grid-template-columns:1fr 140px}

    .btn{
      background:linear-gradient(90deg,var(--accent),var(--accent-2));border:none;padding:10px 12px;border-radius:12px;color:#071033;font-weight:800;cursor:pointer;
      box-shadow:0 8px 30px rgba(109,92,255,0.12);
    }
    .btn.ghost{background:transparent;border:1px solid rgba(255,255,255,0.04);color:var(--accent);font-weight:700}
    .btn:disabled{opacity:0.6;cursor:not-allowed}

    /* suggestion box */
    .suggest{
      margin-top:10px;padding:12px;border-radius:12px;background:linear-gradient(90deg,rgba(255,255,255,0.02),rgba(255,255,255,0.01));border:1px solid rgba(255,255,255,0.03)
    }

    /* database */
    .controls{display:flex;gap:8px;align-items:center;margin-bottom:10px}
    .search{flex:1;display:flex;align-items:center;gap:8px}
    .search input{padding:10px;border-radius:999px;background:rgba(255,255,255,0.02);border:1px solid rgba(255,255,255,0.04);color:inherit}
    table{width:100%;border-collapse:collapse;margin-top:8px}
    th,td{padding:8px 10px;text-align:left;font-size:0.92rem;color:#dbeafe}
    th{font-weight:800;color:#cfe8ff;border-bottom:1px dashed rgba(255,255,255,0.03)}
    tbody tr{transition:background .14s}
    tbody tr:hover{background:rgba(255,255,255,0.02)}
    .action-btn{background:transparent;border:1px solid rgba(255,255,255,0.04);padding:6px 8px;border-radius:10px;color:var(--muted);font-weight:700;cursor:pointer}
    .pill{display:inline-block;padding:6px 8px;border-radius:999px;background:rgba(255,255,255,0.06);font-weight:800;color:var(--accent)}

    /* footer */
    footer{margin-top:18px;text-align:center;color:var(--muted);font-size:0.86rem}

    /* responsive */
    @media (max-width:980px){
      main.grid{grid-template-columns:1fr; }
    }

    /* small animation */
    .fade-up{animation:fadeUp .45s ease both}
    @keyframes fadeUp{from{opacity:0;transform:translateY(8px)}to{opacity:1;transform:none}}

    /* toast */
    .toast{position:fixed;right:20px;bottom:20px;padding:12px 14px;border-radius:12px;background:linear-gradient(90deg,var(--accent),var(--accent-2));color:#071033;font-weight:800;box-shadow:0 14px 40px rgba(2,6,23,0.5);display:none}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="logo" aria-hidden="true">KDA</div>
      <div>
        <h1>KDA: Vernacular Writing — UX Demo</h1>
        <p class="lead">A polished demo showing a user-friendly data-entry form, guidance on field selection, and automated transfer to a database sheet.</p>
      </div>
    </header>

    <main class="grid">
      <!-- Left: Main content & form -->
      <section class="card fade-up" aria-labelledby="main-title">
        <div class="hero">
          <div class="badge">Project</div>
          <div>
            <h2 id="main-title" style="margin:0 0 6px 0">Problem & Goals</h2>
            <p class="small">People often write how they speak — resulting in vernacular spellings that cause inconsistency in records, grading issues, or failure in automated processes. This site simulates an Entry Sheet → Database workflow with UX best-practices.</p>
          </div>
        </div>

        <!-- Form -->
        <h3 style="margin-top:8px">Data-entry Form</h3>
        <p class="small">Click any field to see contextual guidance. Submit to move the entry automatically to the Database (simulating automated transfer).</p>

        <form id="entryForm" class="fade-up" aria-label="Vernacular entry form">
          <div style="display:grid;gap:12px">
            <div>
              <label for="name">Full name <span class="small" style="color:var(--muted)">required</span></label>
              <input id="name" type="text" placeholder="e.g., Maria Johnson" required
                     onfocus="setHint('name','Enter the full name to keep records clear.')" onblur="clearHint('name')">
              <div id="hint-name" class="hint" aria-live="polite"></div>
            </div>

            <div>
              <label for="vern">Vernacular sentence <span class="small" style="color:var(--muted)">required</span></label>
              <textarea id="vern" placeholder="Write how someone would say it (e.g., 'gonna', 'wanna', dialect forms')" required
                        onfocus="setHint('vern','Type the sentence exactly how it would be spoken — the demo will suggest a standardized version.')" onblur="clearHint('vern')"></textarea>
              <div id="hint-vern" class="hint" aria-live="polite"></div>
            </div>

            <div class="row" style="align-items:end">
              <div style="flex:1">
                <label for="category">Category</label>
                <select id="category" onfocus="setHint('category','Choose the type: Informal / Dialect / Slang / Other')" onblur="clearHint('category')">
                  <option value="Informal">Informal</option>
                  <option value="Dialect">Dialect / Regional</option>
                  <option value="Slang">Slang</option>
                  <option value="Other">Other</option>
                </select>
                <div id="hint-category" class="hint"></div>
              </div>

              <div style="width:160px">
                <label for="date">Date</label>
                <input id="date" type="text" readonly>
                <div class="hint" id="hint-date"></div>
              </div>
            </div>

            <div>
              <label>Standardization suggestion</label>
              <div class="suggest" id="suggestion" aria-live="polite">(Type a vernacular sentence to see a suggestion)</div>
              <div class="hint">This rule-based demo suggests replacements for common spoken forms (e.g., "gonna" → "going to"). For production, replace with NLP or server rules.</div>
            </div>

            <div style="display:flex;gap:10px;align-items:center">
              <button type="button" class="btn" id="previewBtn" title="Preview suggestion">Preview</button>
              <button type="submit" class="btn" id="saveBtn" title="Save to database">Save to Database</button>
              <button type="button" class="btn ghost" id="clearBtn" title="Clear form">Clear</button>
              <div id="status" class="small" style="margin-left:8px"></div>
            </div>
          </div>
        </form>

        <hr style="margin:14px 0;border:none;border-top:1px solid rgba(255,255,255,0.02)">

        <h3>Why this UX helps</h3>
        <ul style="color:var(--muted);margin-top:8px">
          <li>Dedicated entry screen reduces user errors and confusion.</li>
          <li>On-focus prompts offer immediate guidance (like spreadsheets' input messages).</li>
          <li>Automated transfer demonstrates how inputs are safely moved to a database/calculation sheet with transformations applied.</li>
        </ul>

      </section>

      <!-- Right: Database + controls -->
      <aside class="card fade-up" aria-labelledby="db-title">
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:10px">
          <h3 id="db-title" style="margin:0">Database (Automated Transfer)</h3>
          <div class="pill">Live</div>
        </div>

        <div class="controls">
          <div class="search" role="search">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M21 21l-4.35-4.35" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/><circle cx="11" cy="11" r="6.5" stroke="currentColor" stroke-width="1.5"/></svg>
            <input id="search" placeholder="Search name, vernacular, suggestion..." aria-label="search entries">
          </div>
          <button class="btn ghost" id="exportBtn" title="Export CSV">Export CSV</button>
          <button class="btn ghost" id="clearDbBtn" title="Clear database">Clear DB</button>
        </div>

        <div style="max-height:360px;overflow:auto;border-radius:12px;padding-right:6px">
          <table id="dbTable" role="grid" aria-live="polite">
            <thead>
              <tr><th>#</th><th>Name</th><th>Vernacular</th><th>Suggestion</th><th>Category</th><th>Actions</th></tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>

        <div style="display:flex;gap:12px;align-items:center;margin-top:12px">
          <div style="flex:1">
            <small class="small">Category distribution</small>
            <canvas id="catChart" height="80"></canvas>
          </div>
          <div style="width:140px">
            <div class="small">Rows: <strong id="rowCount">0</strong></div>
            <div class="small">Last saved: <span id="lastSaved">—</span></div>
          </div>
        </div>

        <hr style="margin:12px 0;border:none;border-top:1px solid rgba(255,255,255,0.02)">

        <div class="small" style="color:var(--muted)">
          <strong>Demo notes:</strong>
          <ol>
            <li>Entry form = "Entry Sheet".</li>
            <li>Submit = automated transfer into "Database Sheet".</li>
            <li>Standardizer = example of formula replication / transformation.</li>
          </ol>
        </div>
      </aside>
    </main>

    <footer>
      <div class="small">Created for your KDA assignment • Tip: mention form → database → persistence flow in your report for full marks.</div>
    </footer>
  </div>

  <div id="toast" class="toast" role="status" aria-live="polite">Saved ✓</div>

  <script>
    // ---------- State & persistence ----------
    const DB_KEY = 'kda_vern_demo_v2';
    let db = JSON.parse(localStorage.getItem(DB_KEY) || '[]');

    // Elements
    const dateEl = document.getElementById('date');
    const vernEl = document.getElementById('vern');
    const nameEl = document.getElementById('name');
    const catEl = document.getElementById('category');
    const suggestionEl = document.getElementById('suggestion');
    const tbody = document.querySelector('#dbTable tbody');
    const rowCount = document.getElementById('rowCount');
    const lastSaved = document.getElementById('lastSaved');
    const toast = document.getElementById('toast');

    // Fill date
    dateEl.value = new Date().toLocaleDateString();

    // ---------- Standardizer (improved rules) ----------
    function standardize(text){
      if(!text) return '';
      let s = text.trim();

      // Normalize some punctuation & stray characters
      s = s.replace(/[“”]/g, '"').replace(/[‘’]/g, "'");

      // small rule-based replacements (illustrative)
      const rules = [
        [/\bgonna\b/gi, 'going to'],
        [/\bwanna\b/gi, 'want to'],
        [/\bgimme\b/gi, 'give me'],
        [/\bgoin'?g?\b/gi, 'going'],
        [/\bain('?t)?\b/gi, "isn't"],
        [/\bim\b/gi, "I'm"],
        [/\bya\b/gi, 'you'],
        [/\bgotta\b/gi, 'have to'],
        [/\blemme\b/gi, 'let me'],
        [/\btho\b/gi, 'though'],
        [/\b'bout\b/gi, 'about'],
        [/\bcu\b/gi, 'see you']
      ];
      rules.forEach(([pat, rep]) => s = s.replace(pat, rep));

      // Fix double spaces
      s = s.replace(/\s{2,}/g, ' ');

      // Capitalize first letter
      s = s.charAt(0).toUpperCase() + s.slice(1);

      // Ensure punctuation
      if(!/[.!?]$/.test(s)) s += '.';

      return s;
    }

    // ---------- Hints ----------
    function setHint(id, text){
      const el = document.getElementById('hint-'+id) || document.getElementById('hint-'+id);
      if(el) el.textContent = text;
    }
    function clearHint(id){
      const el = document.getElementById('hint-'+id);
      if(el) el.textContent = '';
    }

    // Live suggestion
    vernEl.addEventListener('input', () => {
      const s = standardize(vernEl.value);
      suggestionEl.textContent = s || '(Type a vernacular sentence to see a suggestion)';
    });

    // Preview button
    document.getElementById('previewBtn').addEventListener('click', () => {
      if(!vernEl.value.trim()){ alert('Enter a vernacular sentence to preview.'); return; }
      suggestionEl.textContent = standardize(vernEl.value);
      showToast('Preview ready');
    });

    // ---------- Save / Automated Transfer ----------
    document.getElementById('entryForm').addEventListener('submit', (e) => {
      e.preventDefault();
      const name = nameEl.value.trim();
      const vern = vernEl.value.trim();
      const category = catEl.value;
      const date = dateEl.value;

      if(!name || !vern){ alert('Please complete required fields.'); return; }

      // automated transformation (like formula replication)
      const suggestion = standardize(vern);

      const row = { id: Date.now(), name, vern, suggestion, category, date };
      db.push(row);
      localStorage.setItem(DB_KEY, JSON.stringify(db));
      renderTable();
      vernEl.value = '';
      suggestionEl.textContent = '(Type a vernacular sentence to see a suggestion)';
      lastSaved.textContent = new Date().toLocaleString();
      showToast('Saved to database ✓');
    });

    // ---------- Render / edit / delete / search ----------
    function renderTable(filter=''){
      tbody.innerHTML = '';
      const list = db.filter(r => {
        if(!filter) return true;
        const q = filter.toLowerCase();
        return (r.name + ' ' + r.vern + ' ' + r.suggestion + ' ' + r.category).toLowerCase().includes(q);
      });

      list.forEach((r, i) => {
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td>${i+1}</td>
          <td>${escapeHtml(r.name)}</td>
          <td>${escapeHtml(r.vern)}</td>
          <td>${escapeHtml(r.suggestion)}</td>
          <td>${escapeHtml(r.category)}</td>
          <td>
            <button class="action-btn" onclick="editRow(${r.id})" title="Edit">Edit</button>
            <button class="action-btn" onclick="deleteRow(${r.id})" title="Delete" style="margin-left:8px">Delete</button>
          </td>
        `;
        tbody.appendChild(tr);
      });
      rowCount.textContent = db.length;
      updateChart();
    }

    window.editRow = function(id){
      const idx = db.findIndex(x => x.id === id);
      if(idx === -1) return;
      const row = db[idx];
      nameEl.value = row.name;
      vernEl.value = row.vern;
      catEl.value = row.category;
      suggestionEl.textContent = row.suggestion;
      // remove original row so when saved it's updated (simulates pulling into entry sheet)
      db.splice(idx,1);
      localStorage.setItem(DB_KEY, JSON.stringify(db));
      renderTable();
      showToast('Loaded for edit — make changes and save');
    }

    window.deleteRow = function(id){
      if(!confirm('Delete this entry?')) return;
      db = db.filter(x => x.id !== id);
      localStorage.setItem(DB_KEY, JSON.stringify(db));
      renderTable();
      showToast('Deleted ✓');
    }

    document.getElementById('search').addEventListener('input', (e) => {
      renderTable(e.target.value.trim());
    });

    // Export CSV
    document.getElementById('exportBtn').addEventListener('click', () => {
      if(db.length === 0){ alert('No rows to export'); return; }
      const rows = [['#','Name','Vernacular','Suggestion','Category','Date']];
      db.forEach((r, i) => rows.push([i+1, r.name, r.vern, r.suggestion, r.category, r.date]));
      const csv = rows.map(r => r.map(c => `"${String(c).replace(/"/g,'""')}"`).join(',')).join('\n');
      const blob = new Blob([csv], {type:'text/csv;charset=utf-8;'});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a'); a.href = url; a.download = 'kda_vernacular_db.csv'; a.click();
      URL.revokeObjectURL(url);
      showToast('CSV exported');
    });

    // Clear DB
    document.getElementById('clearDbBtn').addEventListener('click', () => {
      if(!confirm('Clear entire database? This cannot be undone.')) return;
      db = []; localStorage.setItem(DB_KEY, JSON.stringify(db)); renderTable(); lastSaved.textContent = '—'; showToast('Database cleared');
    });

    // Clear form
    document.getElementById('clearBtn').addEventListener('click', () => {
      nameEl.value = ''; vernEl.value = ''; catEl.value = 'Informal'; suggestionEl.textContent = '(Type a vernacular sentence to see a suggestion)';
      showToast('Form cleared');
    });

    // ---------- Utilities ----------
    function escapeHtml(s){ return String(s || '').replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;').replace(/'/g,'&#039;'); }

    function showToast(msg){
      toast.textContent = msg; toast.style.display = 'block';
      clearTimeout(window._toastTimer);
      window._toastTimer = setTimeout(()=> toast.style.display = 'none', 2100);
    }

    // ---------- Chart ----------
    let chart;
    function updateChart(){
      const counts = db.reduce((acc, r) => { acc[r.category] = (acc[r.category]||0) + 1; return acc; }, {});
      const labels = Object.keys(counts).length ? Object.keys(counts) : ['Informal','Dialect','Slang','Other'];
      const data = labels.map(l => counts[l] || 0);
      if(!chart){
        const ctx = document.getElementById('catChart').getContext('2d');
        chart = new Chart(ctx, {
          type: 'doughnut',
          data: {
            labels,
            datasets: [{
              data,
              backgroundColor: ['#6d5cff','#00d4ff','#ffb86b','#ff7ab6']
            }]
          },
          options: {
            cutout: '66%',
            plugins:{legend:{position:'bottom',labels:{color:'#cfe8ff'}}},
            responsive:true
          }
        });
      } else {
        chart.data.labels = labels; chart.data.datasets[0].data = data; chart.update();
      }
    }

    // ---------- Init & samples ----------
    // preload sample entries if empty so the site looks impressive immediately

      
